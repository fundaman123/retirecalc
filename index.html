<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <title>Simple retirement calculator</title>

    <!-- Bootstrap -->
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">


  </head>
  <body>


<h1 class="text-center">Retirement calculator</h1>

<div class="form-group col-md-12">

<div class="form-group col-md-4 col-md-offset-4">
  <label for="age" class="control-label">Country:</label>
  <select class="form-control" id="sel1" onchange="init ($(this).val())">
    <option>India</option>
    <option>US</option>
  </select>
</div>

<div class="clearfix"></div>

<div class="form-group col-md-4">
  <label for="age" class="control-label">Current Age:</label>
  <input type="number" class="form-control" id="age" value=30>
</div>

<div class="form-group col-md-4">
  <label for="pwd" class="control-label">Retirement Age:</label>
  <input type="number" class="form-control" id="retirement" value=60>
</div>

<div class="form-group col-md-4">
  <label for="pwd" class="control-label">Lifespan:</label>
  <input type="number" class="form-control" id="lifespan" value=80>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Income per month after taxes:</label>
  <input type="number" class="form-control" id="income" value=50000>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Expenses per month:</label>
  <input type="number" class="form-control" id="expense" value=4000>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Expected annual raise in salary:</label>
  <div class="input-group">
    <input type="number" class="form-control" id="raise" value=10>
    <div class="input-group-addon">%</div>
  </div>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Current investments:</label>
  <input type="number" class="form-control" id="investments" value=1000000>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Investment Returns during accumulation</label>
  <div class="input-group">
    <input type="number" class="form-control" id="reta" value=12.0>
    <div class="input-group-addon">%</div>
  </div>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Investment Returns during retirement</label>
  <div class="input-group">
    <input type="number" class="form-control" id="retr" value=10.0>
    <div class="input-group-addon">%</div>
  </div>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Inflation during accumulation</label>
  <div class="input-group">
    <input type="number" class="form-control" id="infa" value=7.0>
    <div class="input-group-addon">%</div>
  </div>
</div>

<div class="form-group col-md-6">
  <label for="pwd" class="control-label">Inflation during retirement</label>
  <div class="input-group">
    <input type="number" class="form-control" id="infr" value=6.0>
    <div class="input-group-addon">%</div>
  </div>
</div>

<div class="form-group col-md-4 col-md-offset-4">
<button class="btn btn-primary btn-block btn-lg" onclick="calculate()">Calculate</button>
</div>

<div class="col-md-10 col-md-offset-1">
  <div id="chart"></div>
</div>

<div class="col-md-10 col-md-offset-1">
<table id="results" class="table table-bordered table-striped">
<thead><tr><th>Age</th><th>Corpus</th><th>Income</th><th>Expenses</th><th>Withdrawal rate</th></tr></thead>
</table>
</div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>

    <script type="text/javascript">
       google.load('visualization', '1.1', {packages: ['line']});

       function init (country) {
         if (country == 'US') {
           $('#income').val(3000);
           $('#expense').val(2800);
           $('#raise').val(3);
           $('#investments').val(10000);
  
           $('#reta').val(6);
           $('#retr').val(6);
  
           $('#infa').val(3);
           $('#infr').val(3);

         } else {
           $('#income').val(50000);
           $('#expense').val(40000);
           $('#raise').val(10);
           $('#investments').val(1000000);
  
           $('#reta').val(12);
           $('#retr').val(10);
  
           $('#infa').val(7);
           $('#infr').val(6);
         }
       }

       function calculate () {
         var age = $('#age').val()*1.0;
         var ret = $('#retirement').val()*1.0;
         var life = $('#lifespan').val()*1.0;

         var income = $('#income').val();
         var expense = $('#expense').val();
         var raise = $('#raise').val();
         var investments = $('#investments').val();

         var reta = $('#reta').val();
         var retr = $('#retr').val();

         var infa = $('#infa').val();
         var infr = $('#infr').val();

         $('#results tr.calc').remove();

         var data = new google.visualization.DataTable();
         data.addColumn('number', 'Age');
         data.addColumn('number', 'Corpus');
         data.addColumn('number', 'Income');
         data.addColumn('number', 'Expense');



       for (;age<life;age++) {

     if (age<ret) {
       investments *= (1.0+reta/100.0);
       investments += 12*(income-expense);
       income *= (1.0+raise/100.0);
       expense *= (1.0+infa/100.0);
     }

     else {
       income = 0;
       investments *= (1.0+retr/100.0);
       investments -= 12*(expense);
       expense *= (1.0+infr/100.0);
        }

        if (investments >= 0) {
           $('#results').append ('<tr class="calc"><td>'+(age+1)+'</td><td>'+Math.round(investments).toLocaleString()+'</td><Td>'+Math.round(income*12).toLocaleString()+'</td><Td>'+Math.round(expense*12).toLocaleString()+'</td><td>'+Math.round(1200*expense/investments)+'%</td></tr>');
        } else {
           $('#results').append ('<tr class="calc danger"><td>'+(age+1)+'</td><td>'+Math.round(investments).toLocaleString()+'</td><Td>'+Math.round(income*12).toLocaleString()+'</td><Td>'+Math.round(expense*12).toLocaleString()+'</td><td>'+Math.round(1200*expense/investments)+'%</td></tr>');

        }


      data.addRows([
        [age, Math.round(investments) > 0 ? Math.round (investments) : 0, Math.round(income*12), Math.round(expense*12)],
      ]);

        }


      var options = {
        chart: {
          title: 'Withdrawal of investment'
        },
        width: 800,
        height: 300,
        axes: {
          x: {
            0: {side: 'bottom'}
          }
        }
      };

      var chart = new google.charts.Line(document.getElementById('chart'));

      chart.draw(data, options);
    }
  </script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  </body>
</html>
